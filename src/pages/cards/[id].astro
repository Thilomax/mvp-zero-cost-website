---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdsPlaceholder from '../../components/AdsPlaceholder.astro';
import cards from '../../data/cards.json';

// Generate one static page per card id
export function getStaticPaths() {
  return cards.map((card) => ({
    params: { id: card.id },
  }));
}

const { id } = Astro.params;
const card = cards.find((c) => c.id === id);
if (!card) {
  throw new Error(`Card with id '${id}' not found`);
}
---

<BaseLayout title={`${card.name} â€“ Review & Details`} description={`Learn about ${card.name} from ${card.issuer}. Fees, interest, rewards and more.`}>
  <section class="max-w-5xl mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-2">{card.name}</h1>
    <p class="text-neutral-dark mb-6">{card.description}</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="bg-white rounded shadow p-4">
        <h2 class="font-semibold mb-2">At a glance</h2>
        <ul class="list-disc ml-5 space-y-1">
          <li><strong>Issuer:</strong> {card.issuer}</li>
          <li><strong>Annual fee:</strong> {card.annual_fee === 0 ? '0 NOK' : `${card.annual_fee} NOK`}</li>
          <li><strong>Interest:</strong> {card.interest_rate}%</li>
          <li><strong>Rewards:</strong> {card.rewards}</li>
          <li><strong>Travel insurance:</strong> {card.insurance ? 'Yes' : 'No'}</li>
        </ul>
      </div>

      <div class="bg-white rounded shadow p-4">
        <h2 class="font-semibold mb-2">Apply</h2>
        <p class="mb-3 text-sm text-neutral-dark">
          This button may use an affiliate link (see disclosure).
        </p>
        <a href={card.affiliate_url} rel="nofollow sponsored" class="inline-block bg-accent text-white px-4 py-2 rounded hover:opacity-90">
          Apply for {card.name}
        </a>
      </div>
    </div>

    <div class="mt-8">
      <AdsPlaceholder />
    </div>
  </section>
</BaseLayout>
